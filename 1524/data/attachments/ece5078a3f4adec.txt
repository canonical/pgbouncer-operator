[32mINFO    [0m pytest_operator.plugin:plugin.py:834 Model status:

Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.1.8    unsupported  03:13:10Z

App                  Version  Status       Scale  Charm                Channel      Rev  Exposed  Message
landscape-client              maintenance      6  landscape-client     latest/edge   69  no       Adding client PPA..
pgbouncer            1.21.0   maintenance      3  pgbouncer                           0  no       Updating database relation connection information
postgresql           14.11    active           3  postgresql           14/edge      393  no       
postgresql-test-app           active           3  postgresql-test-app  latest/edge  101  no       received database credentials of the first database
ubuntu-advantage              error            6  ubuntu-advantage     latest/edge   79  no       hook failed: "config-changed"

Unit                    Workload     Agent      Machine  Public address  Ports     Message
postgresql-test-app/0   active       idle       0        10.120.126.29             received database credentials of the first database
  landscape-client/0    active       executing           10.120.126.29             (config-changed) Client registered!
  pgbouncer/1           active       idle                10.120.126.29             
  ubuntu-advantage/0    maintenance  executing           10.120.126.29             (config-changed) Configuring
postgresql-test-app/1*  active       idle       1        10.120.126.215            received database credentials of the first database
  landscape-client/1*   active       executing           10.120.126.215            (start) Client registered!
  pgbouncer/0*          maintenance  idle                10.120.126.215            Updating database relation connection information
  ubuntu-advantage/2    error        idle                10.120.126.215            hook failed: "config-changed"
postgresql-test-app/2   active       idle       2        10.120.126.74             received database credentials of the first database
  landscape-client/2    active       executing           10.120.126.74             (config-changed) Client registered!
  pgbouncer/2           active       idle                10.120.126.74             
  ubuntu-advantage/1    maintenance  executing           10.120.126.74             (config-changed) Configuring
postgresql/0            active       idle       3        10.120.126.228  5432/tcp  
  landscape-client/3    active       executing           10.120.126.228            (config-changed) Client registered!
  ubuntu-advantage/6    maintenance  executing           10.120.126.228            (config-changed) Configuring
postgresql/1            active       idle       4        10.120.126.114  5432/tcp  
  landscape-client/4    active       executing           10.120.126.114            (config-changed) Client registered!
  ubuntu-advantage/3    maintenance  executing           10.120.126.114            (config-changed) Configuring
postgresql/2*           active       idle       5        10.120.126.19   5432/tcp  
  landscape-client/5    maintenance  executing           10.120.126.19             (install) Adding client PPA..
  ubuntu-advantage/5*   active       executing           10.120.126.19             (config-changed) Attached (esm-apps,esm-infra)

Machine  State    Address         Inst id        Base          AZ  Message
0        started  10.120.126.29   juju-abc59e-0  ubuntu@22.04      Running
1        started  10.120.126.215  juju-abc59e-1  ubuntu@22.04      Running
2        started  10.120.126.74   juju-abc59e-2  ubuntu@22.04      Running
3        started  10.120.126.228  juju-abc59e-3  ubuntu@22.04      Running
4        started  10.120.126.114  juju-abc59e-4  ubuntu@22.04      Running
5        started  10.120.126.19   juju-abc59e-5  ubuntu@22.04      Running

[32mINFO    [0m pytest_operator.plugin:plugin.py:840 Juju error logs:

machine-5: 03:03:29 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-5: 03:03:29 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-5: 03:03:29 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
unit-postgresql-2: 03:03:30 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-1: 03:03:39 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-1: 03:03:39 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-1: 03:03:39 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-postgresql-test-app-1: 03:03:40 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-0: 03:03:41 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-0: 03:03:41 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-0: 03:03:41 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-4: 03:03:41 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-4: 03:03:41 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-4: 03:03:41 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
unit-postgresql-test-app-0: 03:03:41 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-3: 03:03:43 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-3: 03:03:43 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-3: 03:03:43 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
unit-postgresql-1: 03:03:43 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-2: 03:03:44 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-2: 03:03:44 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-2: 03:03:44 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-postgresql-0: 03:03:44 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-postgresql-test-app-2: 03:03:46 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-pgbouncer-0: 03:03:50 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-pgbouncer-1: 03:03:53 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-pgbouncer-2: 03:03:57 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-2: 03:11:52 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-0: 03:11:52 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-1: 03:11:52 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-3: 03:11:52 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-ubuntu-advantage-5: 03:11:55 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-4: 03:11:57 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-landscape-client-5: 03:11:57 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-ubuntu-advantage-3: 03:11:57 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-ubuntu-advantage-2: 03:12:27 ERROR unit.unit-ubuntu-advantage-2.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 2183, in _run
    result = run(args, **kwargs)
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-ubuntu-advantage-2/config-get', '--format=json')' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 210, in <module>
    main(UbuntuAdvantageCharm)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/main.py", line 426, in main
    charm = charm_class(framework)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 69, in __init__
    self._setup_proxy_env()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 79, in _setup_proxy_env
    self.env["http_proxy"] = self.config.get("override-http-proxy") or self.env.get(
  File "/usr/lib/python3.10/_collections_abc.py", line 824, in get
    return self[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 547, in __getitem__
    return self._data[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 531, in _data
    data = self._lazy_data = self._load()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 1092, in _load
    return self._backend.config_get()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 2299, in config_get
    out = self._run('config-get', return_output=True, use_json=True)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/model.py", line 2189, in _run
    raise ModelError(e.stderr)
ops.model.ModelError: b'ERROR not implemented for restricted context not implemented\n'
unit-ubuntu-advantage-1: 03:12:27 ERROR unit.unit-ubuntu-advantage-1.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 2183, in _run
    result = run(args, **kwargs)
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-ubuntu-advantage-1/config-get', '--format=json')' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/./src/charm.py", line 210, in <module>
    main(UbuntuAdvantageCharm)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/main.py", line 426, in main
    charm = charm_class(framework)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/./src/charm.py", line 69, in __init__
    self._setup_proxy_env()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/./src/charm.py", line 79, in _setup_proxy_env
    self.env["http_proxy"] = self.config.get("override-http-proxy") or self.env.get(
  File "/usr/lib/python3.10/_collections_abc.py", line 824, in get
    return self[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 547, in __getitem__
    return self._data[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 531, in _data
    data = self._lazy_data = self._load()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 1092, in _load
    return self._backend.config_get()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 2299, in config_get
    out = self._run('config-get', return_output=True, use_json=True)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-1/charm/venv/ops/model.py", line 2189, in _run
    raise ModelError(e.stderr)
ops.model.ModelError: b'ERROR not implemented for restricted context not implemented\n'
unit-ubuntu-advantage-2: 03:12:27 ERROR juju.worker.meterstatus error running "meter-status-changed": exit status 1
unit-ubuntu-advantage-1: 03:12:28 ERROR juju.worker.meterstatus error running "meter-status-changed": exit status 1
unit-ubuntu-advantage-0: 03:12:28 ERROR unit.unit-ubuntu-advantage-0.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 2183, in _run
    result = run(args, **kwargs)
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-ubuntu-advantage-0/config-get', '--format=json')' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/./src/charm.py", line 210, in <module>
    main(UbuntuAdvantageCharm)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/main.py", line 426, in main
    charm = charm_class(framework)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/./src/charm.py", line 69, in __init__
    self._setup_proxy_env()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/./src/charm.py", line 79, in _setup_proxy_env
    self.env["http_proxy"] = self.config.get("override-http-proxy") or self.env.get(
  File "/usr/lib/python3.10/_collections_abc.py", line 824, in get
    return self[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 547, in __getitem__
    return self._data[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 531, in _data
    data = self._lazy_data = self._load()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 1092, in _load
    return self._backend.config_get()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 2299, in config_get
    out = self._run('config-get', return_output=True, use_json=True)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-0/charm/venv/ops/model.py", line 2189, in _run
    raise ModelError(e.stderr)
ops.model.ModelError: b'ERROR not implemented for restricted context not implemented\n'
unit-ubuntu-advantage-0: 03:12:28 ERROR juju.worker.meterstatus error running "meter-status-changed": exit status 1
unit-ubuntu-advantage-6: 03:12:29 ERROR unit.unit-ubuntu-advantage-6.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 2183, in _run
    result = run(args, **kwargs)
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-ubuntu-advantage-6/config-get', '--format=json')' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/./src/charm.py", line 210, in <module>
    main(UbuntuAdvantageCharm)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/main.py", line 426, in main
    charm = charm_class(framework)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/./src/charm.py", line 69, in __init__
    self._setup_proxy_env()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/./src/charm.py", line 79, in _setup_proxy_env
    self.env["http_proxy"] = self.config.get("override-http-proxy") or self.env.get(
  File "/usr/lib/python3.10/_collections_abc.py", line 824, in get
    return self[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 547, in __getitem__
    return self._data[key]
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 531, in _data
    data = self._lazy_data = self._load()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 1092, in _load
    return self._backend.config_get()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 2299, in config_get
    out = self._run('config-get', return_output=True, use_json=True)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-6/charm/venv/ops/model.py", line 2189, in _run
    raise ModelError(e.stderr)
ops.model.ModelError: b'ERROR not implemented for restricted context not implemented\n'
unit-ubuntu-advantage-6: 03:12:29 ERROR juju.worker.meterstatus error running "meter-status-changed": exit status 1
unit-ubuntu-advantage-2: 03:13:06 ERROR unit.ubuntu-advantage/2.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 210, in <module>
    main(UbuntuAdvantageCharm)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/main.py", line 438, in main
    _emit_charm_event(charm, dispatcher.event_name)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/main.py", line 150, in _emit_charm_event
    event_to_emit.emit(*args, **kwargs)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/framework.py", line 355, in emit
    framework._emit(event)  # noqa
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/framework.py", line 856, in _emit
    self._reemit(event_path)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/venv/ops/framework.py", line 931, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 105, in config_changed
    self._handle_subscription_state()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 158, in _handle_subscription_state
    status = get_status_output()
  File "/var/lib/juju/agents/unit-ubuntu-advantage-2/charm/./src/charm.py", line 55, in get_status_output
    output = subprocess.check_output(["ubuntu-advantage", "status", "--all", "--format", "json"])
  File "/usr/lib/python3.10/subprocess.py", line 421, in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['ubuntu-advantage', 'status', '--all', '--format', 'json']' returned non-zero exit status 1.
unit-ubuntu-advantage-2: 03:13:07 ERROR juju.worker.uniter.operation hook "config-changed" (via hook dispatching script: dispatch) failed: exit status 1

[32mINFO    [0m pytest_operator.plugin:plugin.py:904 Forgetting main...